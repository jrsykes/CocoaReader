Setting stuff up...
##################################################
Image input size:  586
Image resize applied
Initializing Datasets and Dataloaders...
Building model...
Traceback (most recent call last):
  File "/users/jrs596/scripts/CocoaReader/CocoaNet/PhyloNet_SR/Torch_Custom_CNNs2.2.1.py", line 180, in <module>
    train()
  File "/users/jrs596/scripts/CocoaReader/CocoaNet/PhyloNet_SR/Torch_Custom_CNNs2.2.1.py", line 128, in train
    model = toolbox.build_model(num_classes=None, arch=args.arch, config=config)
  File "/users/jrs596/scripts/CocoaReader/utils/toolbox.py", line 37, in build_model
    model_ft = PhytNet_SRAutoencoder(config=config)
  File "/users/jrs596/scripts/CocoaReader/utils/ArchitectureZoo.py", line 236, in __init__
    self.decoder = TransformerDecoder(feature_dim, num_heads, num_layers, batch_size)
  File "/users/jrs596/scripts/CocoaReader/utils/ArchitectureZoo.py", line 170, in __init__
    self.decoder_blocks = nn.ModuleList([TransformerDecoderBlock(feature_dim, num_heads) for _ in range(num_layers)])
  File "/users/jrs596/scripts/CocoaReader/utils/ArchitectureZoo.py", line 170, in <listcomp>
    self.decoder_blocks = nn.ModuleList([TransformerDecoderBlock(feature_dim, num_heads) for _ in range(num_layers)])
  File "/users/jrs596/scripts/CocoaReader/utils/ArchitectureZoo.py", line 122, in __init__
    self.self_attn = nn.MultiheadAttention(d_model, nhead)
  File "/users/jrs596/scratch/python_environments/envs/torch5/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 991, in __init__
    assert self.head_dim * num_heads == self.embed_dim, "embed_dim must be divisible by num_heads"
AssertionError: embed_dim must be divisible by num_heads